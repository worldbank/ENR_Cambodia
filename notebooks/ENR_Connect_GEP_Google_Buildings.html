

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Mapping unelectrified households</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/ENR_Connect_GEP_Google_Buildings';</script>
    <link rel="canonical" href="https://worldbank.github.io/template/notebooks/ENR_Connect_GEP_Google_Buildings.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Apr 21, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://www.worldbank.org/en/about/unit/unit-dec">World Bank DEC</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.worldbank.org/en/research/dime">World Bank DIME</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/worldbank/template" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/worldbank/template/edit/main/notebooks/ENR_Connect_GEP_Google_Buildings.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/worldbank/template/issues/new?title=Issue%20on%20page%20%2Fnotebooks/ENR_Connect_GEP_Google_Buildings.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/ENR_Connect_GEP_Google_Buildings.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mapping unelectrified households</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mapping-unelectrified-households">
<h1>Mapping unelectrified households<a class="headerlink" href="#mapping-unelectrified-households" title="Permalink to this heading">#</a></h1>
<p>This notebook focuses on identifying households in electrified settlements that are not yet electrified. The proposed methodology is as follows:</p>
<ol class="arabic simple">
<li><p>Use the settlements from the <a class="reference external" href="https://electrifynow.energydata.info/explore/kh-2">Global Electrification Platform</a> to identify settlements that are partially electrified.<br />
a. Each of these settlements has a number of new connections to make to reach universal electrification</p></li>
<li><p>Map the building footprints to the GEP settlements; those buildings that do not intersect a settlement are mapped to the nearest settlement</p></li>
<li><p>Calculate the distance from the buildings to the MV network</p></li>
<li><p>For each GEP settlement, identify the individual buildings to be electrified to satisfy the number of new connections required</p></li>
<li><p>[TODO] Connect the buildings to the license areas and tabulate distances to grids</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1">#import GOSTrocks.rasterMisc as rMisc</span>
<span class="c1">#import GOSTrocks.dataMisc as dMisc</span>
<span class="c1">#import GOSTrocks.mapMisc as mapMisc</span>
<span class="kn">from</span> <span class="nn">GOSTrocks.misc</span> <span class="kn">import</span> <span class="n">tPrint</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso3</span> <span class="o">=</span> <span class="s1">&#39;KHM&#39;</span>
<span class="n">m_crs</span> <span class="o">=</span> <span class="mi">32648</span>
<span class="n">out_folder</span> <span class="o">=</span> <span class="s2">&quot;C:/WBG/Work/KHM_Energy/data&quot;</span>

<span class="n">wsf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;WSF&quot;</span><span class="p">,</span> <span class="s2">&quot;wsf.tif&quot;</span><span class="p">)</span>
<span class="n">ghsl_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;GHSL&quot;</span><span class="p">,</span> <span class="s2">&quot;ghsl.tif&quot;</span><span class="p">)</span>
<span class="n">overture_buildings</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;overture&quot;</span><span class="p">,</span> <span class="s2">&quot;overture_download_2024_03_29.csv&quot;</span><span class="p">)</span>
<span class="n">overture_raster</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;overture&quot;</span><span class="p">,</span> <span class="s2">&quot;overture_download_2024_03_29.tif&quot;</span><span class="p">)</span>
<span class="n">overture_raster_points</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;overture&quot;</span><span class="p">,</span> <span class="s2">&quot;overture_download_2024_03_29_points.tif&quot;</span><span class="p">)</span>
<span class="n">ghs_smod</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;URBAN&quot;</span><span class="p">,</span> <span class="s2">&quot;GHS_SMOD.tif&quot;</span><span class="p">)</span>
<span class="n">ghs_ucbd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;URBAN&quot;</span><span class="p">,</span> <span class="s2">&quot;GHS_UCBD.gpkg&quot;</span><span class="p">)</span>
<span class="n">ntl_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;NTL&quot;</span><span class="p">,</span> <span class="s2">&quot;VIIRS_KHM&quot;</span><span class="p">)</span>
<span class="n">google_buildings</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;Google_Buildings&quot;</span><span class="p">,</span> <span class="s2">&quot;GOB_cambodia.shp&quot;</span><span class="p">)</span>
<span class="n">gep_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;GEP&quot;</span><span class="p">)</span>
<span class="n">gep_settlements</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gep_folder</span><span class="p">,</span> <span class="s2">&quot;final_clusters.shp&quot;</span><span class="p">)</span>
<span class="n">gep_attributes</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gep_folder</span><span class="p">,</span> <span class="s2">&quot;kh-2-0_0_0_0_1_0.csv&quot;</span><span class="p">)</span>
<span class="n">google_buildings_attributed_GEP</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gep_folder</span><span class="p">,</span> <span class="s2">&quot;GOB_gep.csv&quot;</span><span class="p">)</span>
<span class="n">gridfinder_grid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;GridFinder&quot;</span><span class="p">,</span> <span class="s2">&quot;grid.gpkg&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="n">wsf_file</span><span class="p">,</span> <span class="n">ghsl_file</span><span class="p">,</span> <span class="n">ghs_smod</span><span class="p">]:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>

<span class="c1"># get country extent from geopandas</span>
<span class="n">world_filepath</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">world_filepath</span><span class="p">)</span>
<span class="n">country</span> <span class="o">=</span> <span class="n">world</span><span class="p">[</span><span class="n">world</span><span class="o">.</span><span class="n">iso_a3</span> <span class="o">==</span> <span class="n">iso3</span><span class="p">]</span>
<span class="n">country</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\WB411133\AppData\Local\Temp\ipykernel_24208\2620423151.py:25: FutureWarning: The geopandas.dataset module is deprecated and will be removed in GeoPandas 1.0. You can get the original &#39;naturalearth_lowres&#39; data from https://www.naturalearthdata.com/downloads/110m-cultural-vectors/.
  world_filepath = gpd.datasets.get_path(&#39;naturalearth_lowres&#39;)
c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\geopandas\geodataframe.py:1525: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  super().__setitem__(key, value)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in GEP settlements</span>
<span class="n">gep_d</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gep_settlements</span><span class="p">)</span>
<span class="n">gep_sindex</span> <span class="o">=</span> <span class="n">gep_d</span><span class="o">.</span><span class="n">sindex</span>
<span class="n">gep_a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">gep_attributes</span><span class="p">)</span>

<span class="c1"># read in Google Buildings</span>
<span class="n">build_d</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">google_buildings</span><span class="p">)</span>
<span class="n">build_sindex</span> <span class="o">=</span> <span class="n">build_d</span><span class="o">.</span><span class="n">sindex</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">google_buildings_attributed_GEP</span><span class="p">):</span>
    <span class="c1"># attach GEP settlement ids to Google Buildings</span>
    <span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gep_d</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>    
        <span class="n">candidate_buildings</span> <span class="o">=</span> <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">build_sindex</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bounds</span><span class="p">))]</span>
        <span class="n">sel_buildings</span> <span class="o">=</span> <span class="n">candidate_buildings</span><span class="p">[</span><span class="n">candidate_buildings</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">])]</span>
        <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel_buildings</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cnt</span><span class="o">/</span><span class="n">gep_d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">tPrint</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>

    <span class="c1"># For buildings that are not in a GEP settlement, assign them to the nearest settlement</span>
    <span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">missing_buildings</span> <span class="o">=</span> <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">missing_buildings</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">buffer_dist</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">n_settlements</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">n_settlements</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">possible_matches_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gep_sindex</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">buffer_dist</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">))</span>
            <span class="n">possible_matches</span> <span class="o">=</span> <span class="n">gep_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">possible_matches_index</span><span class="p">]</span>
            <span class="n">n_settlements</span> <span class="o">=</span> <span class="n">possible_matches</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">buffer_dist</span> <span class="o">+=</span> <span class="mf">0.1</span>
        <span class="n">dist_calc</span> <span class="o">=</span> <span class="n">possible_matches</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
        <span class="n">nearest_id</span> <span class="o">=</span> <span class="n">gep_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dist_calc</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(),</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">nearest_dist</span> <span class="o">=</span> <span class="n">dist_calc</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;gep_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nearest_id</span>
        <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;gep_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nearest_dist</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cnt</span><span class="o">/</span><span class="n">missing_buildings</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">tPrint</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">build_d</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">,</span><span class="s1">&#39;gep_dist&#39;</span><span class="p">,</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">google_buildings_attributed_GEP</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">attributed_builds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">google_buildings_attributed_GEP</span><span class="p">)</span>
    <span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attributed_builds</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span>
    <span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attributed_builds</span><span class="p">[</span><span class="s1">&#39;gep_dist&#39;</span><span class="p">]</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14:14:34	0.01
14:14:40	0.02
14:14:42	0.03
14:14:43	0.04
14:15:10	0.05
14:15:14	0.06
14:15:17	0.07
14:15:21	0.08
14:15:22	0.1
14:15:29	0.11
14:15:39	0.12
14:15:40	0.13
14:15:44	0.14
14:15:49	0.15
14:15:51	0.16
14:15:53	0.17
14:15:54	0.18
14:16:03	0.19
14:16:04	0.2
14:16:05	0.21
14:16:26	0.22
14:16:27	0.23
14:16:28	0.24
14:17:11	0.25
14:17:18	0.26
14:17:27	0.28
14:17:28	0.29
14:17:29	0.3
14:17:32	0.31
14:17:35	0.32
14:17:40	0.33
14:17:43	0.34
14:17:45	0.35
14:17:46	0.36
14:17:47	0.37
14:17:49	0.38
14:17:50	0.39
14:17:51	0.4
14:17:52	0.41
14:17:53	0.42
14:17:55	0.43
14:17:59	0.44
14:18:00	0.46
14:18:02	0.47
14:18:06	0.48
14:18:50	0.49
14:18:52	0.5
14:18:54	0.51
14:18:56	0.52
14:18:58	0.53
14:19:09	0.54
14:19:28	0.55
14:19:31	0.56
14:19:32	0.57
14:19:34	0.58
14:19:37	0.59
14:19:38	0.6
14:19:39	0.61
14:19:40	0.62
14:19:41	0.64
14:19:42	0.65
14:19:43	0.66
14:19:44	0.67
14:19:45	0.68
14:19:47	0.69
14:19:48	0.7
14:19:51	0.71
14:19:52	0.72
14:19:53	0.73
14:19:55	0.74
14:19:56	0.75
14:19:57	0.76
14:19:59	0.77
14:20:02	0.78
14:20:03	0.79
14:20:04	0.8
14:20:05	0.82
14:20:06	0.83
14:20:08	0.84
14:20:09	0.85
14:20:11	0.86
14:20:13	0.87
14:20:15	0.88
14:20:16	0.89
14:20:18	0.9
14:20:29	0.91
14:20:30	0.92
14:20:37	0.93
14:20:42	0.94
14:20:46	0.95
14:20:47	0.96
14:20:48	0.97
14:20:49	0.99
14:21:45	1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate distance from Google buildings to GRID</span>
<span class="n">grid_d</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gridfinder_grid</span><span class="p">)</span>
<span class="n">sel_grid</span> <span class="o">=</span> <span class="n">grid_d</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">country</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">country</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">country</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">country</span><span class="o">.</span><span class="n">total_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> 
<span class="n">sel_grid</span> <span class="o">=</span> <span class="n">sel_grid</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">m_crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception ignored in: &lt;function tqdm.__del__ at 0x000002D86B9C6700&gt;
Traceback (most recent call last):
  File &quot;c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\tqdm\std.py&quot;, line 1148, in __del__
    self.close()
  File &quot;c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\tqdm\notebook.py&quot;, line 279, in close
    self.disp(bar_style=&#39;danger&#39;, check_delay=False)
    ^^^^^^^^^
AttributeError: &#39;tqdm_notebook&#39; object has no attribute &#39;disp&#39;
Exception ignored in: &lt;function tqdm.__del__ at 0x000002D86B9C6700&gt;
Traceback (most recent call last):
  File &quot;c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\tqdm\std.py&quot;, line 1148, in __del__
    self.close()
  File &quot;c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\tqdm\notebook.py&quot;, line 279, in close
    self.disp(bar_style=&#39;danger&#39;, check_delay=False)
    ^^^^^^^^^
AttributeError: &#39;tqdm_notebook&#39; object has no attribute &#39;disp&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gridfinder</td>
      <td>LINESTRING (128.88542 71.73125, 128.87708 71.7...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gridfinder</td>
      <td>LINESTRING (128.88542 71.73125, 128.89375 71.7...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gridfinder</td>
      <td>LINESTRING (128.88542 71.70208, 128.88125 71.7...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>openstreetmap</td>
      <td>LINESTRING (128.88958 71.70208, 128.88542 71.7...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>openstreetmap</td>
      <td>LINESTRING (128.88542 71.69792, 128.88542 71.7...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gep_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s2">&quot;Pop&quot;</span><span class="p">,</span><span class="s2">&quot;Pop2030&quot;</span><span class="p">,</span><span class="s2">&quot;NumPeoplePerHH&quot;</span><span class="p">,</span><span class="s2">&quot;IsUrban&quot;</span><span class="p">,</span><span class="s2">&quot;NightLights&quot;</span><span class="p">,</span><span class="s2">&quot;CurrentMVLineDist&quot;</span><span class="p">,</span><span class="s2">&quot;PlannedMVLineDist&quot;</span><span class="p">,</span>
               <span class="s2">&quot;FinalElecCode2020&quot;</span><span class="p">,</span><span class="s2">&quot;FinalElecCode2030&quot;</span><span class="p">,</span><span class="s2">&quot;NewConnections2025&quot;</span><span class="p">,</span><span class="s1">&#39;NewConnections2030&#39;</span><span class="p">]</span>
<span class="n">sel_gep_a</span> <span class="o">=</span> <span class="n">gep_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">gep_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;nConnections&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">sel_gep_a</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;NewConnections2030&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;NumPeoplePerHH&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify GEP settlements that qre fully elecrified</span>
<span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;electrified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sel_gep_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;nConnections&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;electrified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">partially_electrified</span> <span class="o">=</span> <span class="n">sel_gep_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;electrified&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># extract all buildings from settlements that are partially electrified</span>
<span class="c1"># Loop through partially electrified settlements, identify buildings furthest from the grid in those settlements</span>
<span class="n">partially_electrified_buildings</span> <span class="o">=</span> <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">partially_electrified</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])]</span>
<span class="n">partially_electrified_buildings</span> <span class="o">=</span> <span class="n">partially_electrified_buildings</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">m_crs</span><span class="p">)</span>
<span class="n">partially_electrified_buildings</span><span class="p">[</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">partially_electrified_buildings</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">sel_grid</span><span class="o">.</span><span class="n">unary_union</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\groupby.py:1824,</span> in <span class="ni">GroupBy.apply</span><span class="nt">(self, func, include_groups, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1823</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1824</span>     <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_apply_general</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1825</span>     <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1826</span>         <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1827</span>         <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1828</span>         <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span><span class="o">.</span><span class="n">shape</span>
<span class="g g-Whitespace">   </span><span class="mi">1829</span>     <span class="p">):</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\groupby.py:1885,</span> in <span class="ni">GroupBy._python_apply_general</span><span class="nt">(self, f, data, not_indexed_same, is_transform, is_agg)</span>
<span class="g g-Whitespace">   </span><span class="mi">1859</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1860</span><span class="sd"> Apply function f in python space</span>
<span class="g g-Whitespace">   </span><span class="mi">1861</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span><span class="sd">     data after applying f</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1885</span> <span class="n">values</span><span class="p">,</span> <span class="n">mutated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grouper</span><span class="o">.</span><span class="n">apply_groupwise</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span> <span class="k">if</span> <span class="n">not_indexed_same</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\ops.py:919,</span> in <span class="ni">BaseGrouper.apply_groupwise</span><span class="nt">(self, f, data, axis)</span>
<span class="g g-Whitespace">    </span><span class="mi">918</span> <span class="n">group_axes</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">axes</span>
<span class="ne">--&gt; </span><span class="mi">919</span> <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">920</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mutated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_is_indexed_like</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">group_axes</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>

<span class="nn">Cell In[89], line 14,</span> in <span class="ni">identify_furthest_building</span><span class="nt">(x)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">x</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">14</span> <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">n_buildings</span><span class="p">])</span>

<span class="ne">TypeError</span>: slice indices must be integers or None or have an __index__ method

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\indexes\base.py:3805,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3804</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3805</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File index.pyx:167,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File index.pyx:196,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File pandas\\_libs\\hashtable_class_helper.pxi:7081,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">File pandas\\_libs\\hashtable_class_helper.pxi:7089,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: &#39;gep_id&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">89</span><span class="p">],</span> <span class="n">line</span> <span class="mi">16</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">x</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">n_buildings</span><span class="p">])</span>
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="n">buidlings_to_electrify</span> <span class="o">=</span> <span class="n">partially_electrified_buildings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;gep_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">identify_furthest_building</span><span class="p">)</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\groupby.py:1846,</span> in <span class="ni">GroupBy.apply</span><span class="nt">(self, func, include_groups, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1830</span>             <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1831</span>                 <span class="n">message</span><span class="o">=</span><span class="n">_apply_groupings_depr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1832</span>                     <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s2">&quot;apply&quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1835</span>                 <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">   </span><span class="mi">1836</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1837</span>     <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1838</span>         <span class="c1"># gh-20949</span>
<span class="g g-Whitespace">   </span><span class="mi">1839</span>         <span class="c1"># try again, with .apply acting as a filtering</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1843</span>         <span class="c1"># fails on *some* columns, e.g. a numeric operation</span>
<span class="g g-Whitespace">   </span><span class="mi">1844</span>         <span class="c1"># on a string grouper column</span>
<span class="ne">-&gt; </span><span class="mi">1846</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_apply_general</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1848</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\groupby.py:1885,</span> in <span class="ni">GroupBy._python_apply_general</span><span class="nt">(self, f, data, not_indexed_same, is_transform, is_agg)</span>
<span class="g g-Whitespace">   </span><span class="mi">1850</span> <span class="nd">@final</span>
<span class="g g-Whitespace">   </span><span class="mi">1851</span> <span class="k">def</span> <span class="nf">_python_apply_general</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1852</span>     <span class="bp">self</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1857</span>     <span class="n">is_agg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1858</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDFrameT</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1859</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1860</span><span class="sd">     Apply function f in python space</span>
<span class="g g-Whitespace">   </span><span class="mi">1861</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span><span class="sd">         data after applying f</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1885</span>     <span class="n">values</span><span class="p">,</span> <span class="n">mutated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grouper</span><span class="o">.</span><span class="n">apply_groupwise</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="k">if</span> <span class="n">not_indexed_same</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>         <span class="n">not_indexed_same</span> <span class="o">=</span> <span class="n">mutated</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\groupby\ops.py:919,</span> in <span class="ni">BaseGrouper.apply_groupwise</span><span class="nt">(self, f, data, axis)</span>
<span class="g g-Whitespace">    </span><span class="mi">917</span> <span class="c1"># group might be modified</span>
<span class="g g-Whitespace">    </span><span class="mi">918</span> <span class="n">group_axes</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">axes</span>
<span class="ne">--&gt; </span><span class="mi">919</span> <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">920</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mutated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_is_indexed_like</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">group_axes</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">921</span>     <span class="n">mutated</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">Cell In[89], line 11,</span> in <span class="ni">identify_furthest_building</span><span class="nt">(x)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="k">def</span> <span class="nf">identify_furthest_building</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">11</span>     <span class="n">gep_settlement</span> <span class="o">=</span> <span class="n">sel_gep_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">n_buildings</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">gep_settlement</span><span class="p">[</span><span class="s1">&#39;nConnections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">x</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\geopandas\geodataframe.py:1456,</span> in <span class="ni">GeoDataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1450</span> <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1451</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1452</span><span class="sd">     If the result is a column containing only &#39;geometry&#39;, return a</span>
<span class="g g-Whitespace">   </span><span class="mi">1453</span><span class="sd">     GeoSeries. If it&#39;s a DataFrame with any columns of GeometryDtype,</span>
<span class="g g-Whitespace">   </span><span class="mi">1454</span><span class="sd">     return a GeoDataFrame.</span>
<span class="g g-Whitespace">   </span><span class="mi">1455</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1456</span>     <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1457</span>     <span class="c1"># Custom logic to avoid waiting for pandas GH51895</span>
<span class="g g-Whitespace">   </span><span class="mi">1458</span>     <span class="c1"># result is not geometry dtype for multi-indexes</span>
<span class="g g-Whitespace">   </span><span class="mi">1459</span>     <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1460</span>         <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1461</span>         <span class="ow">and</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1464</span>         <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_geometry_type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1465</span>     <span class="p">):</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\frame.py:4090,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">4088</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4089</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">4090</span> <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4091</span> <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">indexer</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4092</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

<span class="nn">File c:\wbg\Anaconda3\envs\urban_test\Lib\site-packages\pandas\core\indexes\base.py:3812,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3807</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span>         <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>         <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3810</span>     <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3811</span>         <span class="k">raise</span> <span class="n">InvalidIndexError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3812</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3813</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3814</span>     <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3815</span>     <span class="c1">#  InvalidIndexError. Otherwise we fall through and re-raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3816</span>     <span class="c1">#  the TypeError.</span>
<span class="g g-Whitespace">   </span><span class="mi">3817</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_indexing_error</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;gep_id&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings_to_electrify</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">partially_electrified_buildings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;gep_id&#39;</span><span class="p">):</span>
    <span class="n">gep_settlement</span> <span class="o">=</span> <span class="n">sel_gep_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sel_gep_a</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;gep_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">n_buildings</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gep_settlement</span><span class="p">[</span><span class="s1">&#39;nConnections&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">buildings_to_electrify</span> <span class="o">=</span> <span class="n">buildings_to_electrify</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">n_buildings</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings_to_electrify</span> <span class="o">=</span> <span class="n">build_d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">build_d</span><span class="p">[</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">buildings_to_electrify</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">buildings_to_electrify</span> <span class="o">=</span> <span class="n">buildings_to_electrify</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">m_crs</span><span class="p">)</span>

<span class="n">sel_grid</span> <span class="o">=</span> <span class="n">sel_grid</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">m_crs</span><span class="p">)</span>
<span class="n">buildings_to_electrify</span><span class="p">[</span><span class="s1">&#39;grid_dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">buildings_to_electrify</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">sel_grid</span><span class="o">.</span><span class="n">unary_union</span><span class="p">)</span>
<span class="n">buildings_to_electrify</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latitude</th>
      <th>longitude</th>
      <th>area_in_me</th>
      <th>confidence</th>
      <th>full_plus_</th>
      <th>geometry</th>
      <th>gep_id</th>
      <th>gep_dist</th>
      <th>grid_dist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.358102</td>
      <td>104.320130</td>
      <td>49.1494</td>
      <td>0.7171</td>
      <td>7P26985C+63R2</td>
      <td>POLYGON ((425567.516 1145081.526, 425566.894 1...</td>
      <td>26039</td>
      <td>0.0</td>
      <td>13626.801841</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10.432327</td>
      <td>104.327650</td>
      <td>78.3979</td>
      <td>0.8026</td>
      <td>7P26C8JH+W3J5</td>
      <td>POLYGON ((426407.396 1153285.444, 426404.700 1...</td>
      <td>45171</td>
      <td>0.0</td>
      <td>5591.271323</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10.432619</td>
      <td>104.327663</td>
      <td>33.0470</td>
      <td>0.7397</td>
      <td>7P26C8MH+23VJ</td>
      <td>POLYGON ((426411.761 1153319.214, 426409.143 1...</td>
      <td>45171</td>
      <td>0.0</td>
      <td>5561.117718</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10.432621</td>
      <td>104.327603</td>
      <td>79.2408</td>
      <td>0.8625</td>
      <td>7P26C8MH+22XV</td>
      <td>POLYGON ((426405.938 1153316.508, 426400.761 1...</td>
      <td>45171</td>
      <td>0.0</td>
      <td>5556.074614</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10.432755</td>
      <td>104.327326</td>
      <td>7.5354</td>
      <td>0.6908</td>
      <td>7P26C8MG+4W43</td>
      <td>POLYGON ((426374.500 1153337.000, 426374.500 1...</td>
      <td>45171</td>
      <td>0.0</td>
      <td>5539.140116</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings_to_electrify</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;full_plus_&#39;</span><span class="p">,</span><span class="s1">&#39;gep_id&#39;</span><span class="p">,</span><span class="s1">&#39;gep_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;grid_dist&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_folder</span><span class="p">,</span> <span class="s2">&quot;buildings_to_electrify.csv&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Development Data Group
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 21, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
 Country borders or names do not necessarily reflect the World Bank Groups official position. All maps are for illustrative purposes and do not imply the expression of any opinion on the part of the World Bank, concerning the legal status of any country or territory or concerning the delimitation of frontiers or boundaries
</div>
<div>
    <b>All content (unless otherwise specified) is subject to the <a href="https://www.mozilla.org/en-US/MPL">Mozilla Public License.</a></b>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>